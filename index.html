<!DOCTYPE html>
  <head>
    <title>Go through WebSocket</title>
    <style media="screen">
      /** { margin:0; padding:0; } /* to remove the top and left whitespace */*/
      html, body { width:100%; height:100%; } /* just to be sure these are full screen*/
      canvas { display:block; } /* To remove the scrollbars */
    </style>
  </head>
  <body>
    <canvas id="canvas" onclick="putPiece(event)"></canvas>

    <script type="text/javascript" charset="utf-8">
      var boardWidth = 700;  // 400px-by-400px
      var boardSize = 15;    // 15x15 board
      var offset = 20;
      var spacing = boardWidth/boardSize;
      var currentBlack = true;

      function drawBoard() {
        var canvas = document.getElementById('canvas');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        var ctx = canvas.getContext('2d');

        ctx.strokeStyle = '#AAAAAA';
        ctx.lineWidth = 2;

        for(var i = 0; i <= boardSize; i++) {
          ctx.beginPath();
          // draw column
          ctx.moveTo(offset + i*spacing, offset);
          ctx.lineTo(offset + i*spacing, boardWidth + offset);

          // draw row
          ctx.moveTo(offset, i*spacing + offset);
          ctx.lineTo(offset + boardWidth, i*spacing + offset);

          ctx.stroke();
        }
      }

      function putPiece(event) {
        var canvas = document.getElementById('canvas');
        var ctx = canvas.getContext('2d');

        var x = event.x;
        var y = event.y;
        var r = 15;

        // find nearest vertex
        var nx = Math.round((x-offset)/spacing)*spacing + offset;
        var ny = Math.round((y-offset)/spacing)*spacing + offset;

        if(nx > offset + boardWidth || ny > offset + boardWidth) {
          return 1;
        }

        console.log("x: " + x + "  nx: " + nx);

        ctx.beginPath();
        ctx.moveTo(nx+r,ny);
        ctx.arc(nx,ny,r,0,2*Math.PI,false);
        ctx.fillStyle = currentBlack ? 'black' : 'white';
        currentBlack = !currentBlack;
        ctx.fill();
        ctx.lineWidth = 3;
        ctx.strokeStyle = '#555555';
        ctx.stroke();
        ctx.endPath();
      }

      drawBoard();
    </script>
  </body>
</html>
