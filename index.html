<!DOCTYPE html>
  <head>
    <title>Go through WebSocket</title>
    <style media="screen">
      /** { margin:0; padding:0; } /* to remove the top and left whitespace */*/
      html, body { width:100%; height:100%; } /* just to be sure these are full screen*/
      canvas { display:block; } /* To remove the scrollbars */
    </style>
  </head>
  <body>
    <canvas id="canvas" onclick="putPiece(event)"></canvas>

    <script type="text/javascript" charset="utf-8">
      var boardWidth = 700;  // 400px-by-400px
      var boardSize = 15;    // 15x15 board
      var offset = 20;
      var spacing = boardWidth/boardSize;
      var currentBlack = true;
      var pieces = create2DArray(boardSize);

      function drawBoard() {
        var canvas = document.getElementById('canvas');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        var ctx = canvas.getContext('2d');

        ctx.strokeStyle = '#AAAAAA';
        ctx.lineWidth = 2;

        for(var i = 0; i <= boardSize; i++) {
          ctx.beginPath();
          // draw column
          ctx.moveTo(offset + i*spacing, offset);
          ctx.lineTo(offset + i*spacing, boardWidth + offset);

          // draw row
          ctx.moveTo(offset, i*spacing + offset);
          ctx.lineTo(offset + boardWidth, i*spacing + offset);

          ctx.stroke();
        }
      }

      function putPiece(event) {
        var canvas = document.getElementById('canvas');
        var ctx = canvas.getContext('2d');

        var x = event.x;
        var y = event.y;
        var r = 15;

        // find nearest vertex
        var idx = Math.round((x-offset)/spacing);
        var idy = Math.round((y-offset)/spacing);
        pieces[idx][idy] = currentBlack ? 0 : 1;
        log2DArray(pieces);
        var nx = idx*spacing + offset;
        var ny = idy*spacing + offset;

        if(nx > offset + boardWidth || ny > offset + boardWidth) {
          return 1;
        }

        ctx.beginPath();
        ctx.moveTo(nx+r,ny);
        ctx.arc(nx,ny,r,0,2*Math.PI,false);
        ctx.fillStyle = currentBlack ? 'black' : 'white';
        currentBlack = !currentBlack;
        ctx.fill();
        ctx.lineWidth = 3;
        ctx.strokeStyle = '#555555';
        ctx.stroke();
        ctx.closePath();
      }

      function create2DArray(size) {
        var board = new Array(size);

        for(var i = 0; i < size; i++) {
          board[i] = new Array(size);
          for(var j = 0; j < size; j++) {
            board[i][j] = null;
          }
        }

        return board;
      }

      function log2DArray(ary) {
        var strAry = "";
        for(var i = 0; i < ary.length; i++) {
          for(var j = 0; j < ary.length; j++) {
            var piece = (ary[i][j] === null) ? '.' : ary[i][j];

            strAry += piece + " ";
          }
          strAry += "\n";
        }
        console.log(strAry);
      }

      drawBoard();
    </script>
  </body>
</html>
